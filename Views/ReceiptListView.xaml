<UserControl x:Class="WPFGrowerApp.Views.ReceiptListView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:vm="clr-namespace:WPFGrowerApp.ViewModels"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance Type={x:Type vm:ReceiptListViewModel}}"
             d:DesignHeight="800" d:DesignWidth="1200"
             Background="{DynamicResource ThemeMainBackground}"
             Focusable="True">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Styles/StandardizedViewTemplate.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        </ResourceDictionary>
    </UserControl.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Breadcrumb -->
            <RowDefinition Height="Auto"/> <!-- Title -->
            <RowDefinition Height="Auto"/> <!-- Search/Filter Bar -->
            <RowDefinition Height="Auto"/> <!-- Statistics -->
            <RowDefinition Height="Auto"/> <!-- Action Buttons -->
            <RowDefinition Height="*"/> <!-- DataGrid -->
            <RowDefinition Height="Auto"/> <!-- Pagination Controls -->
            <RowDefinition Height="Auto"/> <!-- Status Bar -->
        </Grid.RowDefinitions>

        <!-- Breadcrumb Navigation -->
        <materialDesign:ColorZone Grid.Row="0" Style="{StaticResource BreadcrumbNavigationStyle}">
            <StackPanel Orientation="Horizontal">
                <Button Command="{Binding NavigateToDashboardCommand}" 
                        Style="{StaticResource MaterialDesignFlatButton}"
                        Padding="5,0">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Home" Width="16" Height="16" VerticalAlignment="Center" Margin="0,0,5,0"/>
                        <TextBlock Text="Dashboard" FontSize="12"/>
                    </StackPanel>
                </Button>
                <materialDesign:PackIcon Kind="ChevronRight" Width="16" Height="16" 
                                        VerticalAlignment="Center" Margin="5,0"/>
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                    <materialDesign:PackIcon Kind="Receipt" Width="16" Height="16" VerticalAlignment="Center" Margin="0,0,5,0"/>
                    <TextBlock Text="Receipt Management" FontSize="12" FontWeight="SemiBold"/>
                </StackPanel>
            </StackPanel>
        </materialDesign:ColorZone>

        <!-- Title -->
        <TextBlock Grid.Row="1" 
                   Text="Receipt Management" 
                   Style="{StaticResource StandardizedViewTitleStyle}"/>

        <!-- Search and Filter Bar -->
        <materialDesign:Card Grid.Row="2" Style="{StaticResource FiltersActionsPanelStyle}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/> <!-- Search Row -->
                    <RowDefinition Height="Auto"/> <!-- Filters Row -->
                </Grid.RowDefinitions>

                <!-- Search Row -->
                <Grid Grid.Row="0" Style="{StaticResource SearchRowStyle}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="300"/>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBox Grid.Column="0"
                             Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                             materialDesign:HintAssist.Hint="Search receipts..."
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Margin="0,0,10,0">
                        <TextBox.InputBindings>
                            <KeyBinding Key="Enter" Command="{Binding SearchCommand}"/>
                        </TextBox.InputBindings>
                    </TextBox>

                    <DatePicker Grid.Column="1"
                               SelectedDate="{Binding StartDate, UpdateSourceTrigger=PropertyChanged}"
                               materialDesign:HintAssist.Hint="Start Date"
                               Style="{StaticResource MaterialDesignOutlinedDatePicker}"
                               Margin="0,0,10,0"/>

                    <DatePicker Grid.Column="2"
                               SelectedDate="{Binding EndDate, UpdateSourceTrigger=PropertyChanged}"
                               materialDesign:HintAssist.Hint="End Date"
                               Style="{StaticResource MaterialDesignOutlinedDatePicker}"
                               Margin="0,0,10,0"/>

                    <ComboBox Grid.Column="3"
                             ItemsSource="{Binding Products}"
                             SelectedItem="{Binding SelectedProduct, UpdateSourceTrigger=PropertyChanged}"
                             DisplayMemberPath="Description"
                             materialDesign:HintAssist.Hint="Product"
                             Style="{StaticResource MaterialDesignOutlinedComboBox}"
                             Margin="0,0,10,0"/>

                    <ComboBox Grid.Column="4"
                             ItemsSource="{Binding Depots}"
                             SelectedItem="{Binding SelectedDepot, UpdateSourceTrigger=PropertyChanged}"
                             DisplayMemberPath="DepotName"
                             materialDesign:HintAssist.Hint="Depot"
                             Style="{StaticResource MaterialDesignOutlinedComboBox}"
                             Margin="0,0,10,0"/>

                    <CheckBox Grid.Column="5"
                             Content="Show Voided" 
                             IsChecked="{Binding ShowVoided, UpdateSourceTrigger=PropertyChanged}"
                             Margin="0,0,10,0"/>

                    <Button Grid.Column="6"
                           Command="{Binding ClearFiltersCommand}"
                           Style="{StaticResource MaterialDesignOutlinedButton}"
                           Content="Clear Filters"
                           Margin="0,0,10,0"/>

                    <Button Grid.Column="7"
                           Command="{Binding RefreshCommand}"
                           Style="{StaticResource MaterialDesignIconButton}"
                           ToolTip="Refresh"
                           Width="40"
                           Margin="0,0,5,0">
                        <materialDesign:PackIcon Kind="Refresh" Width="20" Height="20"/>
                    </Button>
                </Grid>

                <!-- Filters Row -->
                <Grid Grid.Row="1" Style="{StaticResource FiltersRowStyle}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="120"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="150"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Grid.Column="0" Text="Grade:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    
                    <ComboBox Grid.Column="1"
                             ItemsSource="{Binding Grades}"
                             SelectedItem="{Binding SelectedGrade, UpdateSourceTrigger=PropertyChanged}"
                             Style="{StaticResource MaterialDesignOutlinedComboBox}"
                             Margin="0,0,10,0"/>

                    <TextBlock Grid.Column="2" Text="Created By:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    
                    <ComboBox Grid.Column="3"
                             ItemsSource="{Binding CreatedByUsers}"
                             SelectedItem="{Binding SelectedCreatedBy, UpdateSourceTrigger=PropertyChanged}"
                             Style="{StaticResource MaterialDesignOutlinedComboBox}"
                             Margin="0,0,10,0"/>

                    <CheckBox Grid.Column="4"
                             Content="Quality Checked" 
                             IsChecked="{Binding IsQualityChecked, UpdateSourceTrigger=PropertyChanged}"
                             Margin="0,0,10,0"/>

                    <Button Grid.Column="5"
                           Command="{Binding ExportCommand}"
                           Style="{StaticResource MaterialDesignRaisedButton}"
                           Content="Export"
                           Margin="0,0,10,0"/>
                </Grid>
            </Grid>
        </materialDesign:Card>

        <!-- Receipt Statistics -->
        <materialDesign:Card Grid.Row="3" Margin="0,0,0,10" 
                             Background="{DynamicResource ThemeStatisticsCard}"
                             BorderBrush="{DynamicResource ThemeStatisticsCardBorder}"
                             BorderThickness="1">
            <Grid Margin="15">
                <StackPanel Orientation="Horizontal">
                    <materialDesign:PackIcon Kind="Receipt" 
                                           Width="20" Height="20" 
                                           VerticalAlignment="Center" 
                                           Margin="0,0,8,0"
                                           Foreground="{DynamicResource ThemeAccentColor}"/>
                    <TextBlock Text="{Binding TotalReceipts, StringFormat='{}{0:N0} Receipts'}" 
                              FontWeight="SemiBold"
                              VerticalAlignment="Center"
                              Foreground="{DynamicResource ThemeTextPrimary}"
                              Margin="0,0,20,0"/>
                    
                    <materialDesign:PackIcon Kind="Scale" 
                                           Width="20" Height="20" 
                                           VerticalAlignment="Center" 
                                           Margin="0,0,8,0"
                                           Foreground="{DynamicResource ThemeAccentColor}"/>
                    <TextBlock Text="{Binding TotalGrossWeight, StringFormat='{}{0:N2} lbs Gross'}" 
                              FontWeight="SemiBold"
                              VerticalAlignment="Center"
                              Foreground="{DynamicResource ThemeTextPrimary}"
                              Margin="0,0,20,0"/>
                    
                    <materialDesign:PackIcon Kind="Weight" 
                                           Width="20" Height="20" 
                                           VerticalAlignment="Center" 
                                           Margin="0,0,8,0"
                                           Foreground="{DynamicResource ThemeAccentColor}"/>
                    <TextBlock Text="{Binding TotalNetWeight, StringFormat='{}{0:N2} lbs Net'}" 
                              FontWeight="SemiBold"
                              VerticalAlignment="Center"
                              Foreground="{DynamicResource ThemeTextPrimary}"
                              Margin="0,0,20,0"/>
                    
                    <materialDesign:PackIcon Kind="CheckCircle" 
                                           Width="20" Height="20" 
                                           VerticalAlignment="Center" 
                                           Margin="0,0,8,0"
                                           Foreground="{DynamicResource ThemeAccentColor}"/>
                    <TextBlock Text="{Binding TotalFinalWeight, StringFormat='{}{0:N2} lbs Final'}" 
                              FontWeight="SemiBold"
                              VerticalAlignment="Center"
                              Foreground="{DynamicResource ThemeTextPrimary}"
                              Margin="0,0,20,0"/>
                    
                    <materialDesign:PackIcon Kind="Percent" 
                                           Width="20" Height="20" 
                                           VerticalAlignment="Center" 
                                           Margin="0,0,8,0"
                                           Foreground="{DynamicResource ThemeAccentColor}"/>
                    <TextBlock Text="{Binding AverageDockPercentage, StringFormat='{}{0:N2}% Avg Dock'}" 
                              FontWeight="SemiBold"
                              VerticalAlignment="Center"
                              Foreground="{DynamicResource ThemeTextPrimary}"/>
                </StackPanel>
            </Grid>
        </materialDesign:Card>

        <!-- Action Buttons -->
        <materialDesign:Card Grid.Row="4" Style="{StaticResource FiltersActionsPanelStyle}" Margin="0,0,0,0">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                <Button Command="{Binding AddReceiptCommand}" 
                       Style="{StaticResource PrimaryActionButtonStyle}"
                       Content="Add Receipt"/>

                <Button Command="{Binding EditReceiptCommand}" 
                       Style="{StaticResource SecondaryActionButtonStyle}"
                       Content="Edit Receipt"
                       IsEnabled="{Binding HasSelectedReceipt}"/>

                <Button Command="{Binding ViewReceiptCommand}" 
                       Style="{StaticResource SecondaryActionButtonStyle}"
                       Content="View Details"
                       IsEnabled="{Binding HasSelectedReceipt}"/>

                <Button Command="{Binding DuplicateReceiptCommand}" 
                       Style="{StaticResource SecondaryActionButtonStyle}"
                       Content="Duplicate"
                       IsEnabled="{Binding HasSelectedReceipt}"/>

                <Button Command="{Binding VoidReceiptCommand}" 
                       Style="{StaticResource DangerActionButtonStyle}"
                       Content="Void Receipt"
                       IsEnabled="{Binding CanVoidSelectedReceipt}"/>

                <Button Command="{Binding DeleteReceiptCommand}" 
                       Style="{StaticResource DangerActionButtonStyle}"
                       Content="Delete Receipt"
                       IsEnabled="{Binding CanDeleteSelectedReceipt}"/>

                <Button Command="{Binding PrintReceiptCommand}" 
                       Style="{StaticResource SecondaryActionButtonStyle}"
                       Content="Print"
                       IsEnabled="{Binding HasSelectedReceipt}"/>

                <Button Command="{Binding BulkVoidCommand}" 
                       Style="{StaticResource DangerActionButtonStyle}"
                       Content="Bulk Void"
                       IsEnabled="{Binding HasSelectedReceipts}"/>

                <Button Command="{Binding BulkExportCommand}" 
                       Style="{StaticResource SecondaryActionButtonStyle}"
                       Content="Bulk Export"
                       IsEnabled="{Binding HasSelectedReceipts}"/>
            </StackPanel>
        </materialDesign:Card>

        <!-- DataGrid -->
        <materialDesign:Card Grid.Row="5" Style="{StaticResource MainContentAreaStyle}" Margin="0">
            <!-- Performance Optimizations: Virtualization, Memory, and Rendering -->
            <DataGrid ItemsSource="{Binding Receipts}"
                     SelectedItem="{Binding SelectedReceipt}"
                     Style="{StaticResource EnhancedDataGridStyle}"
                     materialDesign:DataGridAssist.CellPadding="13 8 8 8"
                     materialDesign:DataGridAssist.ColumnHeaderPadding="13 10 8 10"
                     MinHeight="200"
                     MaxHeight="400"
                     VerticalScrollBarVisibility="Auto"
                     
                     VirtualizingPanel.IsVirtualizing="True"
                     VirtualizingPanel.VirtualizationMode="Recycling"
                     EnableRowVirtualization="True"
                     EnableColumnVirtualization="True"
                     ScrollViewer.CanContentScroll="True"
                     
                     AutoGenerateColumns="False"
                     IsReadOnly="True"
                     CanUserAddRows="False"
                     CanUserDeleteRows="False"
                     CanUserReorderColumns="False"
                     CanUserResizeColumns="True"
                     CanUserSortColumns="True"
                     SelectionMode="Single"
                     
                     VirtualizingPanel.CacheLength="5"
                     VirtualizingPanel.CacheLengthUnit="Page"
                     
                     RenderOptions.BitmapScalingMode="LowQuality"
                     RenderOptions.EdgeMode="Aliased">

            <DataGrid.Columns>
                <!-- Receipt Number -->
                <DataGridTextColumn Header="Receipt #" 
                                  Binding="{Binding ReceiptNumber, TargetNullValue='', FallbackValue=''}" 
                                  Width="120" 
                                  IsReadOnly="True"/>

                <!-- Date -->
                <DataGridTextColumn Header="Date" 
                                  Binding="{Binding ReceiptDate, StringFormat={}{0:yyyy-MM-dd}, TargetNullValue='', FallbackValue=''}" 
                                  Width="100" 
                                  IsReadOnly="True"/>

                <!-- Time -->
                <DataGridTextColumn Header="Time" 
                                  Binding="{Binding ReceiptTime, StringFormat={}{0:HH:mm}, TargetNullValue='', FallbackValue=''}" 
                                  Width="80" 
                                  IsReadOnly="True"/>

                <!-- Grower -->
                <DataGridTextColumn Header="Grower" 
                                  Binding="{Binding GrowerName, TargetNullValue='', FallbackValue=''}" 
                                  Width="200" 
                                  IsReadOnly="True"/>

                <!-- Product -->
                <DataGridTextColumn Header="Product" 
                                  Binding="{Binding ProductName, TargetNullValue='', FallbackValue=''}" 
                                  Width="150" 
                                  IsReadOnly="True"/>

                <!-- Depot -->
                <DataGridTextColumn Header="Depot" 
                                  Binding="{Binding DepotName, TargetNullValue='', FallbackValue=''}" 
                                  Width="150" 
                                  IsReadOnly="True"/>

                <!-- Gross Weight -->
                <DataGridTextColumn Header="Gross" 
                                  Binding="{Binding GrossWeight, StringFormat={}{0:N2}, TargetNullValue='0.00', FallbackValue='0.00'}" 
                                  Width="80" 
                                  IsReadOnly="True"/>

                <!-- Tare Weight -->
                <DataGridTextColumn Header="Tare" 
                                  Binding="{Binding TareWeight, StringFormat={}{0:N2}, TargetNullValue='0.00', FallbackValue='0.00'}" 
                                  Width="80" 
                                  IsReadOnly="True"/>

                <!-- Net Weight -->
                <DataGridTextColumn Header="Net" 
                                  Binding="{Binding NetWeight, StringFormat={}{0:N2}, TargetNullValue='0.00', FallbackValue='0.00'}" 
                                  Width="80" 
                                  IsReadOnly="True"/>

                <!-- Dock % -->
                <DataGridTextColumn Header="Dock %" 
                                  Binding="{Binding DockPercentage, StringFormat={}{0:N2}%, TargetNullValue='0.00%', FallbackValue='0.00%'}" 
                                  Width="80" 
                                  IsReadOnly="True"/>

                <!-- Final Weight -->
                <DataGridTextColumn Header="Final" 
                                  Binding="{Binding FinalWeight, StringFormat={}{0:N2}, TargetNullValue='0.00', FallbackValue='0.00'}" 
                                  Width="80" 
                                  IsReadOnly="True"/>

                <!-- Grade -->
                <DataGridTextColumn Header="Grade" 
                                  Binding="{Binding GradeDisplay, TargetNullValue='', FallbackValue=''}" 
                                  Width="80" 
                                  IsReadOnly="True"/>

                <!-- Status -->
                <DataGridTemplateColumn Header="Status" Width="100" IsReadOnly="True">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Border CornerRadius="12" 
                                    Padding="8,4" 
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="{DynamicResource ThemeStatusSuccess}"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding StatusDisplay}" Value="Voided">
                                                <Setter Property="Background" Value="{DynamicResource ThemeStatusError}"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding StatusDisplay}" Value="Pending">
                                                <Setter Property="Background" Value="{DynamicResource ThemeStatusWarning}"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding StatusDisplay}" Value="Processing">
                                                <Setter Property="Background" Value="{DynamicResource ThemeStatusInfo}"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <TextBlock Text="{Binding StatusDisplay, TargetNullValue='', FallbackValue=''}" 
                                           Foreground="White" 
                                           FontWeight="SemiBold" 
                                           FontSize="11"
                                           HorizontalAlignment="Center"/>
                            </Border>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <!-- Created By -->
                <DataGridTextColumn Header="Created By" 
                                  Binding="{Binding CreatedBy, TargetNullValue='', FallbackValue=''}" 
                                  Width="120" 
                                  IsReadOnly="True"/>

                <!-- Actions -->
                <DataGridTemplateColumn Header="Actions" Width="180">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Margin="5" HorizontalAlignment="Left">
                                <Button Command="{Binding DataContext.ViewReceiptCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}" 
                                       CommandParameter="{Binding}"
                                       Style="{StaticResource MaterialDesignIconButton}"
                                       Width="30" Height="30"
                                       ToolTip="View Details">
                                    <materialDesign:PackIcon Kind="Eye" Width="16" Height="16"/>
                                </Button>
                                
                                <Button Command="{Binding DataContext.EditReceiptCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}" 
                                       CommandParameter="{Binding}"
                                       Style="{StaticResource MaterialDesignIconButton}"
                                       Width="30" Height="30"
                                       ToolTip="Edit Receipt">
                                    <materialDesign:PackIcon Kind="Pencil" Width="16" Height="16"/>
                                </Button>
                                
                                <Button Command="{Binding DataContext.PrintReceiptCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}" 
                                       CommandParameter="{Binding}"
                                       Style="{StaticResource MaterialDesignIconButton}"
                                       Width="30" Height="30"
                                       ToolTip="Print Receipt">
                                    <materialDesign:PackIcon Kind="Printer" Width="16" Height="16"/>
                                </Button>
                                
                                <Button Command="{Binding DataContext.VoidReceiptCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}" 
                                       CommandParameter="{Binding}"
                                       Style="{StaticResource MaterialDesignIconButton}"
                                       Width="30" Height="30"
                                       ToolTip="Void Receipt"
                                       IsEnabled="{Binding CanVoid}"
                                       Foreground="{DynamicResource ThemeStatusWarning}">
                                    <materialDesign:PackIcon Kind="Cancel" Width="16" Height="16"/>
                                </Button>
                                
                                <Button Command="{Binding DataContext.DeleteReceiptCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}" 
                                       CommandParameter="{Binding}"
                                       Style="{StaticResource MaterialDesignIconButton}"
                                       Width="30" Height="30"
                                       ToolTip="Delete Receipt"
                                       IsEnabled="{Binding CanDelete}"
                                       Foreground="{DynamicResource ThemeButtonDanger}">
                                    <materialDesign:PackIcon Kind="Delete" Width="16" Height="16"/>
                                </Button>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
            </DataGrid>
        </materialDesign:Card>

        <!-- Pagination Controls -->
        <materialDesign:Card Grid.Row="6" Style="{StaticResource FiltersActionsPanelStyle}" Margin="0,5,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Page Info -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="{Binding CurrentPageInfo}" FontWeight="SemiBold" Margin="0,0,10,0"/>
                    <TextBlock Text="of" Margin="0,0,5,0"/>
                    <TextBlock Text="{Binding TotalPages}" FontWeight="SemiBold"/>
                    <TextBlock Text="pages" Margin="5,0,0,0"/>
                </StackPanel>
                
                <!-- Pagination Buttons -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center">
                    <Button Command="{Binding FirstPageCommand}"
                           Style="{StaticResource MaterialDesignIconButton}"
                           ToolTip="First Page"
                           Width="40" Height="35" Margin="2">
                        <materialDesign:PackIcon Kind="SkipPrevious" Width="20" Height="20"/>
                    </Button>
                    
                    <Button Command="{Binding PreviousPageCommand}"
                           Style="{StaticResource MaterialDesignIconButton}"
                           ToolTip="Previous Page"
                           Width="40" Height="35" Margin="2">
                        <materialDesign:PackIcon Kind="ChevronLeft" Width="20" Height="20"/>
                    </Button>
                    
                    <Button Command="{Binding NextPageCommand}"
                           Style="{StaticResource MaterialDesignIconButton}"
                           ToolTip="Next Page"
                           Width="40" Height="35" Margin="2">
                        <materialDesign:PackIcon Kind="ChevronRight" Width="20" Height="20"/>
                    </Button>
                    
                    <Button Command="{Binding LastPageCommand}"
                           Style="{StaticResource MaterialDesignIconButton}"
                           ToolTip="Last Page"
                           Width="40" Height="35" Margin="2">
                        <materialDesign:PackIcon Kind="SkipNext" Width="20" Height="20"/>
                    </Button>
                </StackPanel>
                
                <!-- Records Per Page -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="Show:" Margin="0,0,5,0"/>
                    <ComboBox SelectedValue="{Binding PageSize}" Width="80" Margin="0,0,5,0">
                        <sys:Int32>50</sys:Int32>
                        <sys:Int32>100</sys:Int32>
                        <sys:Int32>200</sys:Int32>
                        <sys:Int32>500</sys:Int32>
                    </ComboBox>
                    <TextBlock Text="per page"/>
                </StackPanel>
            </Grid>
        </materialDesign:Card>

        <!-- Status Bar -->
        <materialDesign:ColorZone Grid.Row="7" Style="{StaticResource StatusFooterBarStyle}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="Status: " FontWeight="SemiBold"/>
                    <TextBlock Text="{Binding StatusMessage}"/>
                </StackPanel>
                
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <TextBlock Text="Showing: " FontWeight="SemiBold"/>
                    <TextBlock Text="{Binding PaginationInfo}"/>
                    <TextBlock Text=" | " Margin="5,0"/>
                    <TextBlock Text="Last Updated: " FontWeight="SemiBold"/>
                    <TextBlock Text="{Binding LastUpdated, StringFormat={}{0:HH:mm:ss}}"/>
                </StackPanel>
            </Grid>
        </materialDesign:ColorZone>

        <!-- Loading Overlay -->
        <Grid Grid.RowSpan="8" 
              Background="#80000000" 
              Visibility="{Binding IsLoading, Converter={StaticResource BoolToVis}}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <materialDesign:PackIcon Kind="Loading" 
                                        Width="40" 
                                        Height="40" 
                                        Margin="0,0,0,10"
                                        Foreground="{DynamicResource PrimaryHueMidBrush}"/>
                <TextBlock Text="Loading receipts..." 
                          HorizontalAlignment="Center"
                          Style="{StaticResource MaterialDesignBody2TextBlock}"/>
            </StackPanel>
        </Grid>
    </Grid>
</UserControl>
