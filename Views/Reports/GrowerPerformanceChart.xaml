<UserControl x:Class="WPFGrowerApp.Views.Reports.GrowerPerformanceChart"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
             xmlns:converters="clr-namespace:WPFGrowerApp.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="400" d:DesignWidth="800">
    
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/WPFGrowerApp;component/Styles/StandardizedViewTemplate.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <BooleanToVisibilityConverter x:Key="BoolToVis"/>
            <converters:BoolToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
            <converters:GrowerPerformanceConverter x:Key="GrowerPerformanceConverter"/>
        </ResourceDictionary>
    </UserControl.Resources>
    
    <materialDesign:Card Style="{StaticResource KPICardStyle}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <!-- Chart Header -->
            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
                <materialDesign:PackIcon Kind="Trophy" Width="24" Height="24" 
                                         Foreground="{DynamicResource PrimaryHueMidBrush}" 
                                         VerticalAlignment="Center" Margin="0,0,10,0"/>
                <TextBlock Text="Top Performing Growers" 
                           Style="{StaticResource MaterialDesignHeadline6TextBlock}" 
                           VerticalAlignment="Center"/>
            </StackPanel>
            
            <!-- Chart Area -->
            <Grid Grid.Row="1" MinHeight="300">
                <syncfusion:SfChart Header="Top Growers by Payment Amount"
                                    Margin="0,10"
                                    Background="Transparent">
                    
                    <!-- Chart Primary Axis -->
                    <syncfusion:SfChart.PrimaryAxis>
                        <syncfusion:CategoryAxis Header="Growers" 
                                                LabelFormat="{Binding GrowerDisplayName}"
                                                ShowGridLines="True"/>
                    </syncfusion:SfChart.PrimaryAxis>
                    
                    <!-- Chart Secondary Axis -->
                    <syncfusion:SfChart.SecondaryAxis>
                        <syncfusion:NumericalAxis Header="Payment Amount ($)" 
                                                  LabelFormat="C0"
                                                  ShowGridLines="True"/>
                    </syncfusion:SfChart.SecondaryAxis>
                    
                    <!-- Payment Amount Column Series -->
                    <syncfusion:ColumnSeries ItemsSource="{Binding}"
                                             XBindingPath="GrowerDisplayName"
                                             YBindingPath="TotalPayments"
                                             EnableAnimation="True"
                                             Stroke="#2E86AB"
                                             StrokeThickness="1"/>
                    
                    <!-- Receipt Count Column Series (Secondary) -->
                    <syncfusion:ColumnSeries ItemsSource="{Binding}"
                                             XBindingPath="GrowerDisplayName"
                                             YBindingPath="ReceiptCount"
                                             EnableAnimation="True"
                                             Stroke="#E6B800"
                                             StrokeThickness="1"
                                             Opacity="0.7"/>
                    
                    <!-- Chart Legend -->
                    <syncfusion:SfChart.Legend>
                        <syncfusion:ChartLegend DockPosition="Bottom" 
                                                HorizontalAlignment="Center"
                                                Margin="0,10,0,0"/>
                    </syncfusion:SfChart.Legend>
                </syncfusion:SfChart>
                
                <!-- No Data Message -->
                <TextBlock Text="No performance data available" 
                           Style="{StaticResource MaterialDesignBody2TextBlock}" 
                           Opacity="0.7" 
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           Visibility="{Binding Count, Converter={StaticResource BooleanToVisibilityConverter}, ConverterParameter=Inverse}"/>
            </Grid>
            
            <!-- Chart Summary -->
            <Grid Grid.Row="2" Margin="0,15,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                    <TextBlock Text="Top Performer" 
                               Style="{StaticResource MaterialDesignCaptionTextBlock}" 
                               Opacity="0.7" 
                               HorizontalAlignment="Center"/>
                    <TextBlock Style="{StaticResource MaterialDesignBody1TextBlock}" 
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center">
                        <TextBlock.Text>
                            <MultiBinding StringFormat="{}{0}">
                                <Binding Path="." Converter="{StaticResource GrowerPerformanceConverter}" ConverterParameter="TopPerformer"/>
                            </MultiBinding>
                        </TextBlock.Text>
                    </TextBlock>
                </StackPanel>
                
                <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                    <TextBlock Text="Highest Payment" 
                               Style="{StaticResource MaterialDesignCaptionTextBlock}" 
                               Opacity="0.7" 
                               HorizontalAlignment="Center"/>
                    <TextBlock Style="{StaticResource MaterialDesignBody1TextBlock}" 
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center">
                        <TextBlock.Text>
                            <MultiBinding StringFormat="{}{0:C0}">
                                <Binding Path="." Converter="{StaticResource GrowerPerformanceConverter}" ConverterParameter="HighestPayment"/>
                            </MultiBinding>
                        </TextBlock.Text>
                    </TextBlock>
                </StackPanel>
                
                <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                    <TextBlock Text="Average Payment" 
                               Style="{StaticResource MaterialDesignCaptionTextBlock}" 
                               Opacity="0.7" 
                               HorizontalAlignment="Center"/>
                    <TextBlock Style="{StaticResource MaterialDesignBody1TextBlock}" 
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center">
                        <TextBlock.Text>
                            <MultiBinding StringFormat="{}{0:C0}">
                                <Binding Path="." Converter="{StaticResource GrowerPerformanceConverter}" ConverterParameter="AveragePayment"/>
                            </MultiBinding>
                        </TextBlock.Text>
                    </TextBlock>
                </StackPanel>
                
                <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                    <TextBlock Text="Total Growers" 
                               Style="{StaticResource MaterialDesignCaptionTextBlock}" 
                               Opacity="0.7" 
                               HorizontalAlignment="Center"/>
                    <TextBlock Style="{StaticResource MaterialDesignBody1TextBlock}" 
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center">
                        <TextBlock.Text>
                            <MultiBinding StringFormat="{}{0}">
                                <Binding Path="." Converter="{StaticResource GrowerPerformanceConverter}" ConverterParameter="GrowerCount"/>
                            </MultiBinding>
                        </TextBlock.Text>
                    </TextBlock>
                </StackPanel>
            </Grid>
        </Grid>
    </materialDesign:Card>
</UserControl>
