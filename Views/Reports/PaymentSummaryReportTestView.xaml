<UserControl x:Class="WPFGrowerApp.Views.Reports.PaymentSummaryReportTestView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:converters="clr-namespace:WPFGrowerApp.Converters"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="1000">
    
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/WPFGrowerApp;component/Styles/StandardizedViewTemplate.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <BooleanToVisibilityConverter x:Key="BoolToVis"/>
            <converters:BoolToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
            
            <!-- Validation Result Style -->
            <Style x:Key="ValidationErrorStyle" TargetType="TextBlock">
                <Setter Property="Foreground" Value="Red"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
            </Style>
            
            <Style x:Key="ValidationWarningStyle" TargetType="TextBlock">
                <Setter Property="Foreground" Value="Orange"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>
    
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <materialDesign:ColorZone Grid.Row="0" Style="{StaticResource BreadcrumbNavigationStyle}">
            <StackPanel Orientation="Horizontal">
                <materialDesign:PackIcon Kind="TestTube" Width="24" Height="24" 
                                         Foreground="{DynamicResource PrimaryHueMidBrush}" 
                                         VerticalAlignment="Center" Margin="0,0,10,0"/>
                <TextBlock Text="Payment Summary Report - Testing &amp; Validation" 
                           Style="{StaticResource MaterialDesignHeadline5TextBlock}" 
                           VerticalAlignment="Center"/>
            </StackPanel>
        </materialDesign:ColorZone>
        
        <!-- Test Controls -->
        <materialDesign:Card Grid.Row="1" Style="{StaticResource FilterPanelStyle}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Margin="0,0,10,0">
                    <TextBlock Text="Test Data Generation" 
                               Style="{StaticResource MaterialDesignBody2TextBlock}" 
                               Margin="0,0,0,5"/>
                    <TextBox x:Name="GrowerCountTextBox" 
                             Text="50" 
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Margin="0,0,0,5"/>
                    <TextBlock Text="Number of Growers" 
                               Style="{StaticResource MaterialDesignCaptionTextBlock}" 
                               Opacity="0.7"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Margin="10,0,10,0">
                    <TextBlock Text="Time Period" 
                               Style="{StaticResource MaterialDesignBody2TextBlock}" 
                               Margin="0,0,0,5"/>
                    <TextBox x:Name="MonthsBackTextBox" 
                             Text="12" 
                             Style="{StaticResource MaterialDesignOutlinedTextBox}"
                             Margin="0,0,0,5"/>
                    <TextBlock Text="Months Back" 
                               Style="{StaticResource MaterialDesignCaptionTextBlock}" 
                               Opacity="0.7"/>
                </StackPanel>
                
                <StackPanel Grid.Column="2" Margin="10,0,10,0">
                    <TextBlock Text="Test Scenarios" 
                               Style="{StaticResource MaterialDesignBody2TextBlock}" 
                               Margin="0,0,0,5"/>
                    <ComboBox x:Name="TestScenarioComboBox" 
                             Style="{StaticResource MaterialDesignOutlinedComboBox}">
                        <ComboBoxItem Content="Normal Data" IsSelected="True"/>
                        <ComboBoxItem Content="Edge Cases"/>
                        <ComboBoxItem Content="Large Dataset"/>
                        <ComboBoxItem Content="Empty Dataset"/>
                    </ComboBox>
                </StackPanel>
                
                <StackPanel Grid.Column="3" Orientation="Horizontal" VerticalAlignment="Bottom">
                    <Button x:Name="GenerateTestDataButton" 
                            Style="{StaticResource MaterialDesignRaisedButton}"
                            Margin="0,0,10,0"
                            Click="GenerateTestDataButton_Click">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Play" Width="16" Height="16" Margin="0,0,5,0"/>
                                <TextBlock Text="Generate"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>
                    <Button x:Name="ValidateDataButton" 
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            Click="ValidateDataButton_Click">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="CheckCircle" Width="16" Height="16" Margin="0,0,5,0"/>
                                <TextBlock Text="Validate"/>
                            </StackPanel>
                        </Button.Content>
                    </Button>
                </StackPanel>
            </Grid>
        </materialDesign:Card>
        
        <!-- Test Results -->
        <materialDesign:Card Grid.Row="2" Style="{StaticResource MainContentAreaStyle}">
            <TabControl Style="{StaticResource MaterialDesignTabControl}">
                
                <!-- Test Data Tab -->
                <TabItem Header="Test Data">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                        <Grid Margin="20">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Test Data Summary -->
                            <Grid Grid.Row="0" Margin="0,0,0,20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <materialDesign:Card Grid.Column="0" Style="{StaticResource KPICardStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Test Growers" 
                                                   Style="{StaticResource MaterialDesignBody2TextBlock}" 
                                                   Opacity="0.7"/>
                                        <TextBlock x:Name="TestGrowersCount" 
                                                   Text="0" 
                                                   Style="{StaticResource MaterialDesignHeadline4TextBlock}" 
                                                   Foreground="{DynamicResource PrimaryHueMidBrush}"/>
                                    </StackPanel>
                                </materialDesign:Card>
                                
                                <materialDesign:Card Grid.Column="1" Style="{StaticResource KPICardStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Test Receipts" 
                                                   Style="{StaticResource MaterialDesignBody2TextBlock}" 
                                                   Opacity="0.7"/>
                                        <TextBlock x:Name="TestReceiptsCount" 
                                                   Text="0" 
                                                   Style="{StaticResource MaterialDesignHeadline4TextBlock}" 
                                                   Foreground="{DynamicResource PrimaryHueMidBrush}"/>
                                    </StackPanel>
                                </materialDesign:Card>
                                
                                <materialDesign:Card Grid.Column="2" Style="{StaticResource KPICardStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Test Payments" 
                                                   Style="{StaticResource MaterialDesignBody2TextBlock}" 
                                                   Opacity="0.7"/>
                                        <TextBlock x:Name="TestPaymentsTotal" 
                                                   Text="$0" 
                                                   Style="{StaticResource MaterialDesignHeadline4TextBlock}" 
                                                   Foreground="{DynamicResource PrimaryHueMidBrush}"/>
                                    </StackPanel>
                                </materialDesign:Card>
                                
                                <materialDesign:Card Grid.Column="3" Style="{StaticResource KPICardStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Test Weight" 
                                                   Style="{StaticResource MaterialDesignBody2TextBlock}" 
                                                   Opacity="0.7"/>
                                        <TextBlock x:Name="TestWeightTotal" 
                                                   Text="0 lbs" 
                                                   Style="{StaticResource MaterialDesignHeadline4TextBlock}" 
                                                   Foreground="{DynamicResource PrimaryHueMidBrush}"/>
                                    </StackPanel>
                                </materialDesign:Card>
                            </Grid>
                            
                            <!-- Test Data Grid -->
                            <DataGrid Grid.Row="1" 
                                      x:Name="TestDataGrid"
                                      Style="{StaticResource MaterialDesignDataGrid}"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      CanUserReorderColumns="True"
                                      CanUserResizeColumns="True"
                                      CanUserSortColumns="True"
                                      GridLinesVisibility="Horizontal"
                                      HeadersVisibility="Column"
                                      SelectionMode="Single">
                                
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Grower #" 
                                                        Binding="{Binding GrowerNumber}" 
                                                        Width="80" 
                                                        IsReadOnly="True"/>
                                    <DataGridTextColumn Header="Name" 
                                                        Binding="{Binding FullName}" 
                                                        Width="150" 
                                                        IsReadOnly="True"/>
                                    <DataGridTextColumn Header="Province" 
                                                        Binding="{Binding Province}" 
                                                        Width="80" 
                                                        IsReadOnly="True"/>
                                    <DataGridTextColumn Header="Total Receipts" 
                                                        Binding="{Binding TotalReceiptsValueDisplay}" 
                                                        Width="120" 
                                                        IsReadOnly="True"/>
                                    <DataGridTextColumn Header="Total Payments" 
                                                        Binding="{Binding TotalPaymentsMadeDisplay}" 
                                                        Width="120" 
                                                        IsReadOnly="True"/>
                                    <DataGridTextColumn Header="Outstanding" 
                                                        Binding="{Binding OutstandingBalanceDisplay}" 
                                                        Width="120" 
                                                        IsReadOnly="True"/>
                                    <DataGridTextColumn Header="Status" 
                                                        Binding="{Binding PaymentStatus}" 
                                                        Width="100" 
                                                        IsReadOnly="True"/>
                                    <DataGridTextColumn Header="Receipts" 
                                                        Binding="{Binding TotalReceipts}" 
                                                        Width="80" 
                                                        IsReadOnly="True"/>
                                    <DataGridTextColumn Header="Weight" 
                                                        Binding="{Binding TotalWeightDisplay}" 
                                                        Width="100" 
                                                        IsReadOnly="True"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </ScrollViewer>
                </TabItem>
                
                <!-- Validation Results Tab -->
                <TabItem Header="Validation Results">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                        <Grid Margin="20">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Validation Summary -->
                            <Grid Grid.Row="0" Margin="0,0,0,20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <materialDesign:Card Grid.Column="0" Style="{StaticResource KPICardStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Validation Errors" 
                                                   Style="{StaticResource MaterialDesignBody2TextBlock}" 
                                                   Opacity="0.7"/>
                                        <TextBlock x:Name="ValidationErrorsCount" 
                                                   Text="0" 
                                                   Style="{StaticResource MaterialDesignHeadline4TextBlock}" 
                                                   Foreground="Red"/>
                                    </StackPanel>
                                </materialDesign:Card>
                                
                                <materialDesign:Card Grid.Column="1" Style="{StaticResource KPICardStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Validation Warnings" 
                                                   Style="{StaticResource MaterialDesignBody2TextBlock}" 
                                                   Opacity="0.7"/>
                                        <TextBlock x:Name="ValidationWarningsCount" 
                                                   Text="0" 
                                                   Style="{StaticResource MaterialDesignHeadline4TextBlock}" 
                                                   Foreground="Orange"/>
                                    </StackPanel>
                                </materialDesign:Card>
                            </Grid>
                            
                            <!-- Validation Results -->
                            <Grid Grid.Row="1">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Errors List -->
                                <materialDesign:Card Grid.Column="0" Margin="0,0,10,0" Style="{StaticResource KPICardStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Errors" 
                                                   Style="{StaticResource MaterialDesignHeadline6TextBlock}" 
                                                   Margin="0,0,0,15"/>
                                        <ListBox x:Name="ErrorsListBox" 
                                                 MaxHeight="400"
                                                 ScrollViewer.HorizontalScrollBarVisibility="Auto">
                                            <ListBox.ItemTemplate>
                                                <DataTemplate>
                                                    <StackPanel Margin="0,2">
                                                        <TextBlock Text="{Binding Field}" 
                                                                   Style="{StaticResource MaterialDesignCaptionTextBlock}" 
                                                                   FontWeight="SemiBold"/>
                                                        <TextBlock Text="{Binding Message}" 
                                                                   Style="{StaticResource MaterialDesignBody2TextBlock}" 
                                                                   TextWrapping="Wrap"/>
                                                    </StackPanel>
                                                </DataTemplate>
                                            </ListBox.ItemTemplate>
                                        </ListBox>
                                    </StackPanel>
                                </materialDesign:Card>
                                
                                <!-- Warnings List -->
                                <materialDesign:Card Grid.Column="1" Margin="10,0,0,0" Style="{StaticResource KPICardStyle}">
                                    <StackPanel>
                                        <TextBlock Text="Warnings" 
                                                   Style="{StaticResource MaterialDesignHeadline6TextBlock}" 
                                                   Margin="0,0,0,15"/>
                                        <ListBox x:Name="WarningsListBox" 
                                                 MaxHeight="400"
                                                 ScrollViewer.HorizontalScrollBarVisibility="Auto">
                                            <ListBox.ItemTemplate>
                                                <DataTemplate>
                                                    <StackPanel Margin="0,2">
                                                        <TextBlock Text="{Binding Field}" 
                                                                   Style="{StaticResource MaterialDesignCaptionTextBlock}" 
                                                                   FontWeight="SemiBold"/>
                                                        <TextBlock Text="{Binding Message}" 
                                                                   Style="{StaticResource MaterialDesignBody2TextBlock}" 
                                                                   TextWrapping="Wrap"/>
                                                    </StackPanel>
                                                </DataTemplate>
                                            </ListBox.ItemTemplate>
                                        </ListBox>
                                    </StackPanel>
                                </materialDesign:Card>
                            </Grid>
                        </Grid>
                    </ScrollViewer>
                </TabItem>
                
                <!-- Performance Test Tab -->
                <TabItem Header="Performance Test">
                    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                        <Grid Margin="20">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Performance Controls -->
                            <materialDesign:Card Grid.Row="0" Style="{StaticResource KPICardStyle}">
                                <StackPanel>
                                    <TextBlock Text="Performance Testing" 
                                               Style="{StaticResource MaterialDesignHeadline6TextBlock}" 
                                               Margin="0,0,0,15"/>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                            <TextBlock Text="Dataset Size" 
                                                       Style="{StaticResource MaterialDesignBody2TextBlock}" 
                                                       Margin="0,0,0,5"/>
                                            <ComboBox x:Name="PerformanceDatasetSizeComboBox" 
                                                     Style="{StaticResource MaterialDesignOutlinedComboBox}">
                                                <ComboBoxItem Content="Small (100 growers)" Tag="100"/>
                                                <ComboBoxItem Content="Medium (500 growers)" Tag="500" IsSelected="True"/>
                                                <ComboBoxItem Content="Large (1000 growers)" Tag="1000"/>
                                                <ComboBoxItem Content="Very Large (5000 growers)" Tag="5000"/>
                                            </ComboBox>
                                        </StackPanel>
                                        
                                        <StackPanel Grid.Column="1" Margin="10,0,10,0">
                                            <TextBlock Text="Test Type" 
                                                       Style="{StaticResource MaterialDesignBody2TextBlock}" 
                                                       Margin="0,0,0,5"/>
                                            <ComboBox x:Name="PerformanceTestTypeComboBox" 
                                                     Style="{StaticResource MaterialDesignOutlinedComboBox}">
                                                <ComboBoxItem Content="Data Generation" IsSelected="True"/>
                                                <ComboBoxItem Content="Report Generation"/>
                                                <ComboBoxItem Content="Export Test"/>
                                                <ComboBoxItem Content="Validation Test"/>
                                            </ComboBox>
                                        </StackPanel>
                                        
                                        <Button Grid.Column="2" 
                                                x:Name="RunPerformanceTestButton" 
                                                Style="{StaticResource MaterialDesignRaisedButton}"
                                                VerticalAlignment="Bottom"
                                                Click="RunPerformanceTestButton_Click">
                                            <Button.Content>
                                                <StackPanel Orientation="Horizontal">
                                                    <materialDesign:PackIcon Kind="Speedometer" Width="16" Height="16" Margin="0,0,5,0"/>
                                                    <TextBlock Text="Run Test"/>
                                                </StackPanel>
                                            </Button.Content>
                                        </Button>
                                    </Grid>
                                </StackPanel>
                            </materialDesign:Card>
                            
                            <!-- Performance Results -->
                            <materialDesign:Card Grid.Row="1" Style="{StaticResource KPICardStyle}">
                                <StackPanel>
                                    <TextBlock Text="Performance Results" 
                                               Style="{StaticResource MaterialDesignHeadline6TextBlock}" 
                                               Margin="0,0,0,15"/>
                                    <TextBlock x:Name="PerformanceResultsTextBlock" 
                                               Style="{StaticResource MaterialDesignBody2TextBlock}" 
                                               TextWrapping="Wrap"
                                               Text="No performance tests run yet. Click 'Run Performance Test' to begin."/>
                                </StackPanel>
                            </materialDesign:Card>
                        </Grid>
                    </ScrollViewer>
                </TabItem>
            </TabControl>
        </materialDesign:Card>
        
        <!-- Status Bar -->
        <materialDesign:ColorZone Grid.Row="3" Style="{StaticResource StatusFooterBarStyle}">
            <TextBlock x:Name="StatusTextBlock" 
                       Text="Ready for testing" 
                       Style="{StaticResource MaterialDesignBody2TextBlock}" 
                       VerticalAlignment="Center"/>
        </materialDesign:ColorZone>
    </Grid>
</UserControl>
